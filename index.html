<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>حساب العمر - الجزائرية</title>
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <!-- html2canvas Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- jsPDF Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- QR Code Library -->
    <script src="https://unpkg.com/qrcodejs@1.0.0/qrcode.min.js"></script>
    <style>
        body {
            font-family: 'Tajawal', sans-serif;
            background: linear-gradient(135deg, #f0f4f8, #d9e2ec);
            color: #333;
            text-align: center;
            padding: 20px;
            margin: 0;
            transition: background 0.3s ease, color 0.3s ease;
            animation: changeBackground 10s infinite;
            background-size: cover;
        }
        body.dark-mode {
            background: linear-gradient(135deg, #1e1e1e, #121212);
            color: #f0f0f0;
            animation: none;
        }
        body.festival-mode {
            animation: changeFestiveBackground 10s infinite;
        }
        @keyframes changeBackground {
            0% { background-image: url('https://example.com/zellij_pattern1.jpg'); }
            33% { background-image: url('https://example.com/zellij_pattern2.jpg'); }
            66% { background-image: url('https://example.com/zellij_pattern3.jpg'); }
            100% { background-image: url('https://example.com/zellij_pattern1.jpg'); }
        }
        @keyframes changeFestiveBackground {
            0% { background-image: url('https://example.com/yennayer_fest.jpg'); }
            33% { background-image: url('https://example.com/ramadan_lights.jpg'); }
            66% { background-image: url('https://example.com/eid_fitr.jpg'); }
            100% { background-image: url('https://example.com/yennayer_fest.jpg'); }
        }
        .container {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            max-width: 400px;
            margin: 0 auto;
            backdrop-filter: blur(10px);
            transition: background 0.3s ease, box-shadow 0.3s ease;
        }
        body.dark-mode .container {
            background: rgba(30, 30, 30, 0.95);
            box-shadow: 0 10px 30px rgba(255, 255, 255, 0.1);
        }
        h1 {
            color: #2c3e50;
            font-size: 2.2em;
            margin-bottom: 20px;
            transition: color 0.3s ease;
        }
        body.dark-mode h1 {
            color: #f0f0f0;
        }
        .icon {
            font-size: 2em;
            color: #2c3e50;
            margin: 10px;
            transition: color 0.3s ease;
        }
        body.dark-mode .icon {
            color: #f0f0f0;
        }
        .circle-input {
            position: relative;
            margin: 10px;
        }
        .circle-input input[type="text"], .circle-input select {
            padding: 12px 40px 12px 20px;
            border: 2px solid #28a745;
            border-radius: 50px;
            font-size: 1em;
            width: 80%;
            background: rgba(255, 255, 255, 0.8);
            color: #333;
            text-align: center;
            transition: background 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }
        .circle-input input:invalid {
            border-color: #dc3545;
        }
        .circle-input i {
            position: absolute;
            top: 50%;
            right: 15px;
            transform: translateY(-50%);
            color: #28a745;
        }
        body.dark-mode .circle-input input[type="text"], 
        body.dark-mode .circle-input select {
            background: rgba(30, 30, 30, 0.8);
            color: #f0f0f0;
            border-color: #dc3545;
        }
        body.dark-mode .circle-input i {
            color: #dc3545;
        }
        button {
            background-color: #28a745;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 50px;
            font-size: 1.2em;
            cursor: pointer;
            margin: 10px;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        button:hover {
            background-color: #218838;
            transform: scale(1.05);
        }
        button.red {
            background-color: #dc3545;
        }
        button.red:hover {
            background-color: #c82333;
        }
        button.white {
            background-color: #f8f9fa;
            color: #333;
        }
        button.white:hover {
            background-color: #e2e6ea;
        }
        body.dark-mode button {
            background-color: #dc3545;
        }
        body.dark-mode button:hover {
            background-color: #c82333;
        }
        body.dark-mode button.white {
            background-color: #343a40;
            color: #f0f0f0;
        }
        body.dark-mode button.white:hover {
            background-color: #495057;
        }
        .social-share {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 15px;
        }
        .social-share button {
            background-color: #007bff;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .social-share button:hover {
            background-color: #0056b3;
        }
        body.dark-mode .social-share button {
            background-color: #28a745;
        }
        body.dark-mode .social-share button:hover {
            background-color: #218838;
        }
        #result {
            margin-top: 20px;
            font-size: 1.4em;
            color: #2c3e50;
            font-weight: bold;
            transition: color 0.3s ease;
        }
        body.dark-mode #result {
            color: #f0f0f0;
        }
        .funny-text {
            font-style: italic;
            color: #dc3545;
            margin-top: 10px;
            font-size: 1.1em;
            transition: color 0.3s ease;
        }
        body.dark-mode .funny-text {
            color: #ff6b6b;
        }
        #zodiacSign, #funStats, #advice, #gameResult, #visitorCounter, #quizResult {
            margin-top: 15px;
            font-size: 1.2em;
            color: #28a745;
            font-weight: bold;
            transition: color 0.3s ease;
        }
        body.dark-mode #zodiacSign, body.dark-mode #funStats, body.dark-mode #advice,
        body.dark-mode #gameResult, body.dark-mode #visitorCounter, body.dark-mode #quizResult {
            color: #dc3545;
        }
        .footer {
            margin-top: 20px;
            font-size: 0.9em;
            color: #6c757d;
            transition: color 0.3s ease;
        }
        body.dark-mode .footer {
            color: #adb5bd;
        }
        .footer a {
            color: #007bff;
            text-decoration: none;
            font-weight: bold;
            transition: color 0.3s ease;
        }
        body.dark-mode .footer a {
            color: #28a745;
        }
        .footer a:hover {
            text-decoration: underline;
        }
        .share-button, .qr-button, .certificate-button, .quiz-button, .download-button {
            background-color: #dc3545;
            display: none;
        }
        .share-button:hover, .qr-button:hover, .certificate-button:hover, .quiz-button:hover, .download-button:hover {
            background-color: #c82333;
        }
        body.dark-mode .share-button, body.dark-mode .qr-button, body.dark-mode .certificate-button,
        body.dark-mode .quiz-button, body.dark-mode .download-button {
            background-color: #28a745;
        }
        body.dark-mode .share-button:hover, body.dark-mode .qr-button:hover, body.dark-mode .certificate-button:hover,
        body.dark-mode .quiz-button:hover, body.dark-mode .download-button:hover {
            background-color: #218838;
        }
        .share-container, .certificate-container {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            width: 90%;
            max-width: 600px;
            margin: 20px auto;
            text-align: center;
            transition: background 0.3s ease, box-shadow 0.3s ease;
            z-index: 1000;
        }
        .share-container h2, .share-container p, .certificate-container h2, .certificate-container p {
            margin: 10px 0;
            font-size: 1.5em;
            color: #333;
        }
        body.dark-mode .share-container, body.dark-mode .certificate-container {
            background: rgba(30, 30, 30, 0.95);
            box-shadow: 0 10px 30px rgba(255, 255, 255, 0.1);
        }
        body.dark-mode .share-container h2, body.dark-mode .share-container p,
        body.dark-mode .certificate-container h2, body.dark-mode .certificate-container p {
            color: #f0f0f0;
        }
        .frame {
            border: 10px solid transparent;
            padding: 20px;
            background: white;
            border-radius: 20px;
            position: relative;
            transition: background 0.3s ease;
        }
        .frame.zellij {
            border-image: url('https://example.com/zellij_pattern.png') 30 stretch;
        }
        .frame.tifinagh {
            border-image: url('https://example.com/tifinagh_pattern.png') 30 stretch;
        }
        body.dark-mode .frame {
            background: #1e1e1e;
        }
        .frame::after {
            content: "مطور بواسطة: Abdelillahdris";
            font-family: 'Tajawal', sans-serif;
            font-size: 1em;
            color: #2c3e50;
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            padding: 0 10px;
            transition: color 0.3s ease, background 0.3s ease;
        }
        body.dark-mode .frame::after {
            color: #f0f0f0;
            background: #1e1e1e;
        }
        .dark-mode-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s ease;
        }
        .dark-mode-toggle:hover {
            background: #0056b3;
        }
        body.dark-mode .dark-mode-toggle {
            background: #28a745;
        }
        body.dark-mode .dark-mode-toggle:hover {
            background: #218838;
        }
        .music-toggle {
            position: fixed;
            top: 60px;
            right: 20px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s ease;
        }
        .music-toggle:hover {
            background: #c82333;
        }
        body.dark-mode .music-toggle {
            background: #ff6b6b;
        }
        body.dark-mode .music-toggle:hover {
            background: #dc3545;
        }
        #qrCode {
            margin: 20px auto;
            display: none;
        }
        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }
        .star {
            position: absolute;
            background: #fff;
            border-radius: 50%;
            animation: fall 2s linear forwards;
        }
        @keyframes fall {
            0% { transform: translateY(-100vh); opacity: 1; }
            100% { transform: translateY(100vh); opacity: 0; }
        }
        .game-container, .quiz-container, .adventure-container {
            margin-top: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 15px;
            display: none;
        }
        body.dark-mode .game-container, body.dark-mode .quiz-container, body.dark-mode .adventure-container {
            background: rgba(30, 30, 30, 0.8);
        }
        .game-container button, .quiz-container button, .adventure-container button {
            margin: 5px;
        }
        .guardian {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 80px;
            height: 80px;
            background: url('https://example.com/hadja_fatma.png') no-repeat center;
            background-size: cover;
            animation: bounce 2s infinite;
            z-index: 1000;
        }
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        .guardian-comment {
            position: fixed;
            bottom: 100px;
            left: 20px;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px;
            border-radius: 10px;
            font-size: 0.9em;
            color: #333;
            max-width: 200px;
            display: none;
            transition: opacity 0.3s ease;
        }
        body.dark-mode .guardian-comment {
            background: rgba(30, 30, 30, 0.9);
            color: #f0f0f0;
        }
        .progress-bar {
            width: 80%;
            height: 20px;
            background: #e9ecef;
            border-radius: 10px;
            margin: 10px auto;
            overflow: hidden;
        }
        .progress {
            width: 0;
            height: 100%;
            background: #28a745;
            transition: width 2s ease;
        }
        body.dark-mode .progress-bar {
            background: #495057;
        }
        body.dark-mode .progress {
            background: #dc3545;
        }
    </style>
</head>
<body>
    <!-- Dark Mode Toggle Button -->
    <button class="dark-mode-toggle" onclick="toggleDarkMode()">🌙</button>
    <!-- Music Toggle Button -->
    <button class="music-toggle" onclick="toggleMusic()">🎶</button>
    <!-- Audio Elements -->
    <audio id="bgMusic" loop>
        <source src="path/to/algerian_music.mp3" type="audio/mp3">
    </audio>
    <audio id="clapSound">
        <source src="path/to/clap_sound.mp3" type="audio/mp3">
    </audio>
    <audio id="bravoSound">
        <source src="path/to/bravo.mp3" type="audio/mp3">
    </audio>
    <audio id="errorSound">
        <source src="path/to/ya_wili.mp3" type="audio/mp3">
    </audio>
    <!-- Stars Animation Container -->
    <div class="stars"></div>
    <!-- Guardian Character -->
    <div class="guardian" id="guardian"></div>
    <div class="guardian-comment" id="guardianComment"></div>

    <div class="container">
        <!-- Icon for Fun -->
        <div class="icon">
            <i class="fas fa-birthday-cake"></i>
        </div>
        <h1>حساب العمر - بالطريقة الجزائرية 😎</h1>
        <p>دخل تاريخ ميلادك، اسمك، ولقبك، وخلينا نكتشفو عمرك في مغامرة! 🚀</p>
        
        <!-- Input for Name -->
        <div class="circle-input">
            <input type="text" id="userName" placeholder="اسمك" maxlength="50">
            <i class="fas fa-user"></i>
        </div>
        
        <!-- Input for Birthdate -->
        <div class="circle-input">
            <input type="text" id="birthdate" placeholder="DD/MM/YYYY" maxlength="10" pattern="\d{2}/\d{2}/\d{4}" required>
            <i class="fas fa-calendar-alt"></i>
        </div>
        
        <!-- Input for Custom Title -->
        <div class="circle-input">
            <input type="text" id="customTitle" placeholder="اختر لقبك (مثل بطل الحومة)">
        </div>
        
        <!-- Select Dialect -->
        <div class="circle-input">
            <select id="dialect">
                <option value="darja">دارجة جزائرية</option>
                <option value="kabyle">قبايلية</option>
            </select>
            <i class="fas fa-language"></i>
        </div>
        
        <!-- Frame Style Selector -->
        <div class="circle-input">
            <select id="frameStyle">
                <option value="default">إطار افتراضي</option>
                <option value="zellij">نمط زليج</option>
                <option value="tifinagh">نمط تيفيناغ</option>
            </select>
            <i class="fas fa-border-style"></i>
        </div>
        
        <!-- Background Color Selector -->
        <div class="circle-input">
            <select id="bgColor">
                <option value="white">خلفية بيضاء</option>
                <option value="green">خلفية خضراء</option>
                <option value="red">خلفية حمراء</option>
            </select>
            <i class="fas fa-palette"></i>
        </div>
        
        <!-- Button to Start Adventure -->
        <button onclick="startAdventure()" class="red">
            <i class="fas fa-unlock"></i> افتح صندوق العمر
        </button>
        
        <!-- Adventure Container -->
        <div class="adventure-container" id="adventureContainer">
            <p>رتّب ألوان العلم الجزائري لفتح صندوق العمر! 🇩🇿</p>
            <div class="progress-bar">
                <div class="progress" id="progress"></div>
            </div>
            <button onclick="chooseColor('green')" class="green">أخضر</button>
            <button onclick="chooseColor('white')" class="white">أبيض</button>
            <button onclick="chooseColor('red')" class="red">أحمر</button>
        </div>
        
        <!-- Result Display -->
        <div id="result"></div>
        <div class="funny-text" id="funnyComment"></div>
        <div id="zodiacSign"></div>
        <div id="funStats"></div>
        <div id="advice"></div>
        <div id="gameResult"></div>
        <div id="quizResult"></div>
        <div id="quizScore"></div>
        <div id="visitorCounter"></div>
        
        <!-- Game Container -->
        <div class="game-container" id="gameContainer">
            <p>اختبر عمرك! جاوب على هذا السؤال:</p>
            <p id="gameQuestion"></p>
            <button onclick="answerGame(true)">نعم</button>
            <button onclick="answerGame(false)">لا</button>
        </div>
        
        <!-- Quiz Container -->
        <div class="quiz-container" id="quizContainer">
            <p>تحدي: كم تعرف الجزائر؟ جاوب!</p>
            <p id="quizQuestion"></p>
            <button onclick="answerQuiz(0)">الخيار 1</button>
            <button onclick="answerQuiz(1)">الخيار 2</button>
            <button onclick="answerQuiz(2)">الخيار 3</button>
        </div>
        
        <!-- QR Code Container -->
        <div id="qrCode"></div>
        
        <!-- Share Buttons -->
        <button class="share-button" onclick="shareResult()"><i class="fas fa-image"></i> تحميل صورة</button>
        <button class="download-button" onclick="downloadResult()"><i class="fas fa-file-download"></i> تحميل PDF</button>
        <button class="share-button" onclick="shareToAll()"><i class="fas fa-share-alt"></i> مشاركة في الكل</button>
        <button class="qr-button" onclick="generateQR()"><i class="fas fa-qrcode"></i> رمز QR</button>
        <button class="certificate-button" onclick="generateCertificate()"><i class="fas fa-trophy"></i> شهادة العمر</button>
        <button class="quiz-button" onclick="startQuiz()"><i class="fas fa-flag"></i> تحدي الجزائر</button>
        <div class="social-share" id="socialShare" style="display: none;">
            <button onclick="shareToWhatsApp()" title="مشاركة عبر WhatsApp"><i class="fab fa-whatsapp"></i></button>
            <button onclick="shareToFacebook()" title="مشاركة عبر Facebook"><i class="fab fa-facebook"></i></button>
            <button onclick="shareToX()" title="مشاركة عبر X"><i class="fab fa-x-twitter"></i></button>
            <button onclick="shareToMessenger()" title="مشاركة عبر Messenger"><i class="fab fa-facebook-messenger"></i></button>
        </div>
        
        <!-- Footer with Icon -->
        <div class="footer">
            <i class="fas fa-flag"></i> صنع في الجزائر بحب <i class="fas fa-heart"></i> | 
            <a href="https://www.facebook.com/abdelillah.dris.2025" target="_blank">تواصل معنا</a>
        </div>
    </div>

    <!-- Share Container (Hidden by Default) -->
    <div class="share-container" id="shareContainer">
        <div class="frame" id="shareFrame">
            <h2 id="shareResultText"></h2>
            <p id="shareCommentText"></p>
            <p id="shareZodiacSign"></p>
            <p id="shareFunStats"></p>
            <p id="shareAdvice"></p>
            <p id="shareGameResult"></p>
            <p id="shareQuizResult"></p>
            <p id="shareDateText"></p>
        </div>
    </div>

    <!-- Certificate Container (Hidden by Default) -->
    <div class="certificate-container" id="certificateContainer">
        <div class="frame" id="certificateFrame">
            <h2>شهادة العمر الجزائرية 🏆</h2>
            <p id="certificateName"></p>
            <p id="certificateTitle"></p>
            <p id="certificateAge"></p>
            <p id="certificateZodiac"></p>
            <p id="certificateComment"></p>
            <p id="certificateDate"></p>
            <p id="certificateStamp">معتمد من الحومة 🇩🇿</p>
        </div>
    </div>

    <script>
        // Initialize jsPDF
        const { jsPDF } = window.jspdf;

        // Dark Mode Toggle
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            const darkModeToggle = document.querySelector('.dark-mode-toggle');
            darkModeToggle.innerHTML = document.body.classList.contains('dark-mode') ? '☀️' : '🌙';
        }

        // Music Toggle
        function toggleMusic() {
            const music = document.getElementById('bgMusic');
            music.paused ? music.play() : music.pause();
        }

        // Auto-format and validate date input
        const birthdateInput = document.getElementById('birthdate');
        birthdateInput.addEventListener('input', function (e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length > 2) value = value.slice(0, 2) + '/' + value.slice(2);
            if (value.length > 5) value = value.slice(0, 5) + '/' + value.slice(5);
            e.target.value = value.slice(0, 10);
            showGuardianComment('دخل التاريخ مليح، يا بطل! 😎');
        });

        // Validate date
        function validateDate(day, month, year) {
            try {
                const date = new Date(`${year}-${month}-${day}`);
                const today = new Date();
                return date instanceof Date && !isNaN(date) && date <= today && date.getFullYear() >= 1900;
            } catch (e) {
                return false;
            }
        }

        // Guardian Comments
        function showGuardianComment(text) {
            const comment = document.getElementById('guardianComment');
            comment.innerText = text;
            comment.style.display = 'block';
            setTimeout(() => {
                comment.style.display = 'none';
            }, 3000);
        }

        // Adventure Logic
        let colorOrder = ['green', 'white', 'red'];
        let currentStep = 0;
        function startAdventure() {
            const birthdateValue = document.getElementById('birthdate').value;
            const userName = document.getElementById('userName').value.trim() || "جزائري مجهول";
            if (!birthdateValue.match(/^\d{2}\/\d{2}\/\d{4}$/)) {
                alert('التاريخ غالط، يا خو! 😅');
                showGuardianComment('دخل التاريخ صح، وإلا مانفتحش الصندوق!');
                const errorSound = document.getElementById('errorSound');
                errorSound.play().catch(() => console.log('صوت يا ويلي غير مدعوم'));
                return;
            }
            const adventureContainer = document.getElementById('adventureContainer');
            adventureContainer.style.display = 'block';
            currentStep = 0;
            document.getElementById('progress').style.width = '0%';
            showGuardianComment('رتّب الألوان ونفتحو الصندوق! 🇩🇿');
            sessionStorage.setItem('userName', userName);
            sessionStorage.setItem('birthdate', birthdateValue);
        }
        function chooseColor(color) {
            if (color === colorOrder[currentStep]) {
                currentStep++;
                document.getElementById('progress').style.width = `${(currentStep / 3) * 100}%`;
                showGuardianComment(`برافو! اللون ${currentStep} صحيح! 😍`);
                if (currentStep === 3) {
                    document.getElementById('adventureContainer').style.display = 'none';
                    calculateAge();
                    const bravoSound = document.getElementById('bravoSound');
                    bravoSound.play().catch(() => console.log('صوت برافو غير مدعوم'));
                }
            } else {
                showGuardianComment('واش هذا؟ اللون غالط! حاول ثاني! 😅');
                const errorSound = document.getElementById('errorSound');
                errorSound.play().catch(() => console.log('صوت يا ويلي غير مدعوم'));
            }
        }

        // Get Zodiac Sign
        function getZodiacSign(day, month) {
            const zodiacs = [
                { name: "الجدي", start: "12-22", end: "01-19", comment: "يا الجدي، هادي ومليان حكمة زي الصحراء! 🏜️" },
                { name: "الدلو", start: "01-20", end: "02-18", comment: "الدلو، مختلف كيما نسيم البحر! 🌊" },
                { name: "الحوت", start: "02-19", end: "03-20", comment: "الحوت، قلبك كبير زي قسنطينة! ❤️" },
                { name: "الحمل", start: "03-21", end: "04-19", comment: "الحمل، نار وطاقة زي شمس الجزاير! 🔥" },
                { name: "الثور", start: "04-20", end: "05-20", comment: "الثور، ثابت كيما جبال الأوراس! 🏔️" },
                { name: "الجوزاء", start: "05-21", end: "06-20", comment: "الجوزاء، مليان حياة زي قهوة الصباح! ☕" },
                { name: "السرطان", start: "06-21", end: "07-22", comment: "السرطان، عاطفي زي أغنية راي! 🎶" },
                { name: "الأسد", start: "07-23", end: "08-22", comment: "الأسد، زعيم الحومة! 🦁" },
                { name: "العذراء", start: "08-23", end: "09-22", comment: "العذراء، دقيق كيما زليج! 🖼️" },
                { name: "الميزان", start: "09-23", end: "10-22", comment: "الميزان، متوازن زي طبق كسكس! 🍲" },
                { name: "العقرب", start: "10-23", end: "11-21", comment: "العقرب، غامض كيما ليل الصحراء! 🌙" },
                { name: "القوس", start: "11-22", end: "12-21", comment: "القوس، مغامر زي رحلة لتيمقاد! 🏛️" }
            ];
            const dateStr = `${month.padStart(2, '0')}-${day.padStart(2, '0')}`;
            const zodiac = zodiacs.find(z => {
                const [startMonth, startDay] = z.start.split('-');
                const [endMonth, endDay] = z.end.split('-');
                return (dateStr >= z.start && dateStr <= z.end) ||
                       (z.start > z.end && (dateStr >= z.start || dateStr <= z.end));
            });
            return zodiac ? { name: zodiac.name, comment: zodiac.comment } : { name: "غير معروف", comment: "" };
        }

        // Calculate fun stats
        function calculateFunStats(ageInDays) {
            const heartBeats = Math.floor(ageInDays * 24 * 60 * 70);
            const sleepHours = Math.floor(ageInDays * 8);
            return `نبضات قلبك: <strong>${heartBeats.toLocaleString()}</strong> نبضة! 😍<br>ساعات نومك: <strong>${sleepHours.toLocaleString()}</strong> ساعة! 😴`;
        }

        // Generate advice
        function generateAdvice(age, dialect) {
            const adviceList = {
                darja: {
                    young: ["روح اتعلم شيء جديد، العمر لسه قدامك! 📚", "جرب هواية، يمكن تصير نجم! 🌟"],
                    adult: ["خلّي الحياة زي الكسكس، مليانة لذة! 🍲", "استثمر في نفسك، المستقبل يستناك! 💼"],
                    senior: ["استمتع كيما قهوة الصباح! ☕", "شارك حكمتك مع الصغار! 🧠"]
                },
                kabyle: {
                    young: ["Ruḥ ssuq-d tɣuri, tudert tettawi! 📚", "Ɣer yiwen amezruy, ad tebḍiḍ! 🌟"],
                    adult: ["Tudert am tala, tɛum-d s lḥikma! 🍲", "Ruḥ sɛu lǧehd, lǧil yettṛaǧu! 💼"],
                    senior: ["Qim deg kra n lḥaḍra am atay! ☕", "Bḍu lḥikma nnek d yessawalen! 🧠"]
                }
            };
            const category = age < 18 ? 'young' : age < 50 ? 'adult' : 'senior';
            const advice = adviceList[dialect][category];
            return advice[Math.floor(Math.random() * advice.length)];
        }

        // Game Logic
        let gameScore = 0;
        const gameQuestions = [
            { q: "تحب تاكل الكسكس يوم الجمعة؟ 🍲", positive: true },
            { q: "تشرب القهوة أكثر من 3 مرات في اليوم؟ ☕", positive: false },
            { q: "تعرف تغني أغنية راي قديمة؟ 🎶", positive: true },
            { q: "تتفرج على مباريات الكرة حتى لو نص الليل؟ ⚽", positive: true }
        ];
        function startGame() {
            gameScore = 0;
            const gameContainer = document.getElementById('gameContainer');
            gameContainer.style.display = 'block';
            askGameQuestion();
        }
        function askGameQuestion() {
            const question = gameQuestions[Math.floor(Math.random() * gameQuestions.length)];
            document.getElementById('gameQuestion').innerHTML = question.q;
            sessionStorage.setItem('currentQuestion', JSON.stringify(question));
        }
        function answerGame(answer) {
            const question = JSON.parse(sessionStorage.getItem('currentQuestion'));
            if ((answer && question.positive) || (!answer && !question.positive)) {
                gameScore++;
            }
            if (gameScore >= 2) {
                const titles = [
                    "شيخ الحومة 🏆",
                    "نجم الكسكس 🌟",
                    "ملك الراي 🎤",
                    "بطل قسنطينة 💪"
                ];
                document.getElementById('gameResult').innerHTML = `مبروك! إنت: <strong>${titles[Math.floor(Math.random() * titles.length)]}</strong>`;
                document.getElementById('gameContainer').style.display = 'none';
                showGuardianComment('يا سلااام! إنت بطل الحومة! 🏆');
                const clapSound = document.getElementById('clapSound');
                clapSound.play().catch(() => console.log('صوت التصفيق غير مدعوم'));
            } else {
                askGameQuestion();
            }
        }

        // Quiz Logic
        let quizScore = 0;
        const quizQuestions = [
            {
                q: "وين توجد مقام الشهيد؟",
                options: ["الجزائر العاصمة", "وهران", "قسنطينة"],
                correct: 0
            },
            {
                q: "أي مدينة تسمى مدينة الجسور؟",
                options: ["الجزائر العاصمة", "قسنطينة", "عنابة"],
                correct: 1
            },
            {
                q: "ما هي عاصمة الثقافة القبائلية؟",
                options: ["تيزي وزو", "بجاية", "سطيف"],
                correct: 0
            },
            {
                q: "ما هو الطبق الجزائري اللي يتقدم يوم الجمعة؟",
                options: ["الكسكس", "الشوربة", "المحاجب"],
                correct: 0
            },
            {
                q: "من هو اللاعب الجزائري الملقب بالفنار؟",
                options: ["رابح ماجر", "رياض محرز", "لخضر بلومي"],
                correct: 0
            },
            {
                q: "وين تقع تيمقاد؟",
                options: ["باتنة", "عنابة", "وهران"],
                correct: 0
            },
            {
                q: "ما هو اسم الرقصة التقليدية القبائلية؟",
                options: ["الأهليل", "الرقصة الشاوية", "الرقصة الصحراوية"],
                correct: 0
            },
            {
                q: "أي مدينة تُلقب بعاصمة الشرق؟",
                options: ["قسنطينة", "عنابة", "سكيكدة"],
                correct: 0
            },
            {
                q: "ما هو اسم الجبل اللي فيه مقام سيدي امحمد؟",
                options: ["جبل الأوراس", "جبل الشليا", "جبل تاهات"],
                correct: 1
            },
            {
                q: "من هو الشاعر الجزائري صاحب قصيدة بلادي؟",
                options: ["مفدي زكريا", "محمد العيد", "أحمد سحنون"],
                correct: 0
            },
            {
                q: "ما هي الولاية اللي تشتهر بالتمور؟",
                options: ["بسكرة", "ورقلة", "كليهما"],
                correct: 2
            },
            {
                q: "في أي سنة استقلت الجزائر؟",
                options: ["1962", "1954", "1975"],
                correct: 0
            },
            {
                q: "ما هو اسم المسرح الوطني الجزائري؟",
                options: ["محي الدين", "القصبة", "الجزائر"],
                correct: 0
            },
            {
                q: "من هو المطرب الجزائري صاحب أغنية قاطرة؟",
                options: ["الشاب خالد", "الشاب حسني", "الشاب مامي"],
                correct: 1
            },
            {
                q: "ما هي المدينة اللي تُلقب بجوهرة الغرب؟",
                options: ["وهران", "تلمسان", "مستغانم"],
                correct: 0
            },
            {
                q: "ما هو اسم المنتزه الوطني الشهير في تيزي وزو؟",
                options: ["جورجورة", "الثنية", "القالة"],
                correct: 0
            },
            {
                q: "من هو البطل الجزائري اللي قاد معركة الجرف؟",
                options: ["العربي بن مهيدي", "مصطفى بن بولعيد", "هواري بومدين"],
                correct: 1
            },
            {
                q: "ما هو النوع التقليدي للقهوة الجزائرية؟",
                options: ["قهوة عربي", "قهوة تركية", "قهوة إيطالية"],
                correct: 0
            },
            {
                q: "ما هي الولاية اللي تشتهر بالغزلان؟",
                options: ["الطارف", "سوق أهراس", "قالمة"],
                correct: 0
            },
            {
                q: "ما هو اسم المهرجان الثقافي في تيميمون؟",
                options: ["سبيبة", "توميات", "القورارة"],
                correct: 0
            }
        ];
        function startQuiz() {
            quizScore = 0;
            const quizContainer = document.getElementById('quizContainer');
            quizContainer.style.display = 'block';
            document.getElementById('quizScore').innerHTML = `نقاطك: <strong>${quizScore}</strong>`;
            askQuizQuestion();
        }
        function askQuizQuestion() {
            const question = quizQuestions[Math.floor(Math.random() * quizQuestions.length)];
            document.getElementById('quizQuestion').innerHTML = question.q;
            const buttons = document.querySelectorAll('.quiz-container button');
            buttons.forEach((btn, i) => {
                btn.innerText = question.options[i];
            });
            sessionStorage.setItem('currentQuiz', JSON.stringify(question));
        }
        function answerQuiz(choice) {
            const question = JSON.parse(sessionStorage.getItem('currentQuiz'));
            if (choice === question.correct) {
                quizScore += 10;
                showGuardianComment('برافو! إجابة صحيحة! 😍');
            } else {
                showGuardianComment('أوبس! حاول ثاني! 😅');
            }
            document.getElementById('quizScore').innerHTML = `نقاطك: <strong>${quizScore}</strong>`;
            if (quizScore >= 50) {
                document.getElementById('quizResult').innerHTML = `مبروك! إنت <strong>سلطان الدزاير 🇩🇿</strong>`;
                document.getElementById('quizContainer').style.display = 'none';
                showGuardianComment('واااو! إنت تعرف الجزائر مليح بزاف! 😍');
                const clapSound = document.getElementById('clapSound');
                clapSound.play().catch(() => console.log('صوت التصفيق غير مدعوم'));
            } else {
                askQuizQuestion();
            }
        }

        // Stars Animation
        function createStars() {
            const starsContainer = document.querySelector('.stars');
            for (let i = 0; i < 20; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.width = `${Math.random() * 5}px`;
                star.style.height = star.style.width;
                star.style.left = `${Math.random() * 100}%`;
                star.style.animationDelay = `${Math.random() * 2}s`;
                starsContainer.appendChild(star);
            }
            setTimeout(() => {
                starsContainer.innerHTML = '';
            }, 2000);
        }

        // Fake Age Counter
        function updateVisitorCounter() {
            const comments = [
                "حتى الجيران جاو يحسبو! 😎",
                "الدزاير كلها هنا! 🚀",
                "حسبنا أعمار الصحراء كلها! 🏜️"
            ];
            const count = Math.floor(Math.random() * 1000000) + 100000;
            document.getElementById('visitorCounter').innerHTML = `أعمار محسوبة: <strong>${count.toLocaleString()}</strong>! ${comments[Math.floor(Math.random() * comments.length)]}`;
        }

        // Check for Festivals
        function checkFestival() {
            const today = new Date();
            const month = today.getMonth() + 1;
            const day = today.getDate();
            if ((month === 1 && day <= 12) || (month === 4 && day >= 10 && day <= 12)) {
                document.body.classList.add('festival-mode');
                showGuardianComment('عيد سعيد! كل عام وإنت بخير! 🎉');
            } else {
                document.body.classList.remove('festival-mode');
            }
        }

        function calculateAge() {
            const birthdateValue = sessionStorage.getItem('birthdate');
            const userName = sessionStorage.getItem('userName');
            const customTitle = document.getElementById('customTitle').value.trim() || "بطل الحومة";
            const dialect = document.getElementById('dialect').value;
            const frameStyle = document.getElementById('frameStyle').value;
            const bgColor = document.getElementById('bgColor').value;

            const [day, month, year] = birthdateValue.split('/').map(Number);
            if (!validateDate(day, month, year)) {
                alert('تاريخ الميلاد غير صحيح أو في المستقبل!');
                showGuardianComment('واش هذا التاريخ؟ من المستقبل ولا كيفاه؟ 😜');
                const errorSound = document.getElementById('errorSound');
                errorSound.play().catch(() => console.log('صوت يا ويلي غير مدعوم'));
                return;
            }

            const birthdate = new Date(`${year}-${month}-${day}`);
            const today = new Date();
            let age = today.getFullYear() - birthdate.getFullYear();
            const monthDifference = today.getMonth() - birthdate.getMonth();
            if (monthDifference < 0 || (monthDifference === 0 && today.getDate() < birthdate.getDate())) {
                age--;
            }

            const resultDiv = document.getElementById('result');
            const funnyCommentDiv = document.getElementById('funnyComment');
            const zodiacSignDiv = document.getElementById('zodiacSign');
            const funStatsDiv = document.getElementById('funStats');
            const adviceDiv = document.getElementById('advice');

            // Play clap sound and stars animation
            const clapSound = document.getElementById('clapSound');
            clapSound.play().catch(() => console.log('صوت التصفيق غير مدعوم'));
            createStars();
            showGuardianComment('حسبنا عمرك بنجاح! صندوق العمر إنفتح! 🎉');

            // Update festival mode
            checkFestival();

            // Update visitor counter
            updateVisitorCounter();

            resultDiv.innerHTML = `<i class="fas fa-user"></i> يا ${userName}، عمرك هو: <strong>${age}</strong> سنة!`;

            // Calculate zodiac sign
            const zodiac = getZodiacSign(day.toString(), month.toString());
            zodiacSignDiv.innerHTML = `برجك: <strong>${zodiac.name}</strong>! ${zodiac.comment}`;

            // Calculate fun stats
            const ageInDays = Math.floor((today - birthdate) / (1000 * 60 * 60 * 24));
            funStatsDiv.innerHTML = calculateFunStats(ageInDays);

            // Generate advice
            adviceDiv.innerHTML = `نصيحة ليك: <strong>${generateAdvice(age, dialect)}</strong>`;

            // Comments
            let comments = [];
            if (dialect === "darja") {
                if (age < 18) {
                    comments = [
                        "يا صغير، روح نام ولا تنسى الواجبات! 📚",
                        "عمرك زي قهوة الصباح، كل ما يطول يحلى! ☕",
                        "إنت قد الدزاير، مليان حياة! 🇩🇿"
                    ];
                } else if (age >= 18 && age < 25) {
                    comments = [
                        "شاب عامر، روح شوف لك حياة! 💪",
                        "العمر زي طبق كسكس، مليان لذة! 🍲",
                        "روح اتعلم، المستقبل زي جسر قسنطينة! 🌉"
                    ];
                } else if (age >= 25 && age < 50) {
                    comments = [
                        "استقر وخلّي الحياة زي قهوة الصباح! ☕",
                        "العمر زي أغنية راي، كل ما تكبر تحلى! 🎶",
                        "روح جيب لقب فخم زي ملك الحومة! 🏆"
                    ];
                } else {
                    comments = [
                        "يا عمي، استمتع زي شاي في الصحراء! 🌴",
                        "العمر زي قصبة الجزائر، مليان حكايات! 🏛️",
                        "حكمتك كيما زليج، دايمة! 🖼️"
                    ];
                }
            } else if (dialect === "kabyle") {
                if (age < 18) {
                    comments = [
                        "A winu aqcic, ruḥ ghas i tɣuri! 📚",
                        "Lɛemrek am tirga n Tizi, d asuf! 🏞️",
                        "Ruḥ ssuq-d tafat, tudert tettawi! 🌟"
                    ];
                } else if (age >= 18 && age < 25) {
                    comments = [
                        "Argaz ameqran, ruḥ af-d tudert! 💪",
                        "Lɛemrek am azzar n yewet, yettban! 🌱",
                        "Ruḥ ssuq-d tafat, tudert tettawi! 🌟"
                    ];
                } else if (age >= 25 && age < 50) {
                    comments = [
                        "Ruḥ ssuq-d tafat, tudert tettawi! 🌟",
                        "Lɛemrek am tala n Djurdjura, d lḥikma! 🏔️",
                        "Ruḥ af-d tayri, am akken yella deg Tizi! 💍"
                    ];
                } else {
                    comments = [
                        "A winu amɣar, ruḥ qim deg laman! 😅",
                        "Lɛemrek am taɣect n yennayer, d lḥikma! 🎉",
                        "Ruḥ ssuq-d tafat, tudert tettawi! 🌟"
                    ];
                }
            }

            const randomComment = comments[Math.floor(Math.random() * comments.length)];
            funnyCommentDiv.innerHTML = randomComment;

            // Store data for sharing
            sessionStorage.setItem('userName', userName);
            sessionStorage.setItem('customTitle', customTitle);
            sessionStorage.setItem('age', age);
            sessionStorage.setItem('zodiac', zodiac.name);
            sessionStorage.setItem('zodiacComment', zodiac.comment);
            sessionStorage.setItem('comment', randomComment);
            sessionStorage.setItem('funStats', funStatsDiv.innerHTML);
            sessionStorage.setItem('advice', adviceDiv.innerHTML);
            sessionStorage.setItem('frameStyle', frameStyle);
            sessionStorage.setItem('bgColor', bgColor);

            // Start game
            startGame();

            // Show Share Buttons
            document.querySelectorAll('.share-button').forEach(btn => btn.style.display = 'block');
            document.querySelector('.download-button').style.display = 'block';
            document.querySelector('.qr-button').style.display = 'block';
            document.querySelector('.certificate-button').style.display = 'block';
            document.querySelector('.quiz-button').style.display = 'block';
            document.getElementById('socialShare').style.display = 'flex';
        }

        function shareResult() {
            const frameStyle = sessionStorage.getItem('frameStyle') || 'default';
            const bgColor = sessionStorage.getItem('bgColor') || 'white';
            const shareFrame = document.getElementById('shareFrame');
            shareFrame.className = `frame ${frameStyle}`;
            shareFrame.style.background = bgColor;

            const userName = sessionStorage.getItem('userName');
            const resultDiv = `يا ${userName}، عمرك هو: ${sessionStorage.getItem('age')} سنة!`;
            const funnyCommentDiv = sessionStorage.getItem('comment');
            const zodiacSignDiv = `برجك: ${sessionStorage.getItem('zodiac')}! ${sessionStorage.getItem('zodiacComment')}`;
            const funStatsDiv = sessionStorage.getItem('funStats');
            const adviceDiv = sessionStorage.getItem('advice');
            const gameResultDiv = document.getElementById('gameResult').innerText;
            const quizResultDiv = document.getElementById('quizResult').innerText;
            const date = new Date().toLocaleDateString();

            // Update Share Container Content
            document.getElementById('shareResultText').innerText = resultDiv + ' 🇩🇿';
            document.getElementById('shareCommentText').innerText = funnyCommentDiv;
            document.getElementById('shareZodiacSign').innerText = zodiacSignDiv;
            document.getElementById('shareFunStats').innerText = funStatsDiv;
            document.getElementById('shareAdvice').innerText = adviceDiv;
            document.getElementById('shareGameResult').innerText = gameResultDiv;
            document.getElementById('shareQuizResult').innerText = quizResultDiv;
            document.getElementById('shareDateText').innerText = `تاريخ المشاركة: ${date} ☕`;

            // Show Share Container
            const shareContainer = document.getElementById('shareContainer');
            shareContainer.style.display = 'block';

            // Capture Share Container as Image
            html2canvas(shareContainer, { scale: 2 }).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const link = document.createElement('a');
                link.href = imgData;
                link.download = `عمرك_بالجزائرية_${date}.png`;
                link.click();
            }).catch(err => console.error('خطأ في إنشاء الصورة:', err));

            // Hide Share Container
            setTimeout(() => {
                shareContainer.style.display = 'none';
            }, 1000);
        }

        function downloadResult() {
            const frameStyle = sessionStorage.getItem('frameStyle') || 'default';
            const bgColor = sessionStorage.getItem('bgColor') || 'white';
            const shareFrame = document.getElementById('shareFrame');
            shareFrame.className = `frame ${frameStyle}`;
            shareFrame.style.background = bgColor;

            const userName = sessionStorage.getItem('userName');
            const resultDiv = `يا ${userName}، عمرك هو: ${sessionStorage.getItem('age')} سنة!`;
            const funnyCommentDiv = sessionStorage.getItem('comment');
            const zodiacSignDiv = `برجك: ${sessionStorage.getItem('zodiac')}! ${sessionStorage.getItem('zodiacComment')}`;
            const funStatsDiv = sessionStorage.getItem('funStats');
            const adviceDiv = sessionStorage.getItem('advice');
            const gameResultDiv = document.getElementById('gameResult').innerText;
            const quizResultDiv = document.getElementById('quizResult').innerText;
            const date = new Date().toLocaleDateString();

            // Update Share Container Content
            document.getElementById('shareResultText').innerText = resultDiv + ' 🇩🇿';
            document.getElementById('shareCommentText').innerText = funnyCommentDiv;
            document.getElementById('shareZodiacSign').innerText = zodiacSignDiv;
            document.getElementById('shareFunStats').innerText = funStatsDiv;
            document.getElementById('shareAdvice').innerText = adviceDiv;
            document.getElementById('shareGameResult').innerText = gameResultDiv;
            document.getElementById('shareQuizResult').innerText = quizResultDiv;
            document.getElementById('shareDateText').innerText = `تاريخ المشاركة: ${date} ☕`;

            // Show Share Container
            const shareContainer = document.getElementById('shareContainer');
            shareContainer.style.display = 'block';

            // Generate PDF
            html2canvas(shareContainer, { scale: 2 }).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const pdf = new jsPDF();
                const imgWidth = 190;
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                pdf.addImage(imgData, 'PNG', 10, 10, imgWidth, imgHeight);
                pdf.save(`عمرك_بالجزائرية_${date}.pdf`);
            }).catch(err => console.error('خطأ في إنشاء PDF:', err));

            // Hide Share Container
            setTimeout(() => {
                shareContainer.style.display = 'none';
            }, 1000);
        }

        function shareToAll() {
            if (navigator.share) {
                navigator.share({
                    title: 'حساب العمر الجزائري 😎',
                    text: `اكتشفت عمري بطريقة مضحكة! جربوها: ${window.location.href}`,
                    url: window.location.href
                }).catch(err => console.error('خطأ في المشاركة:', err));
            } else {
                alert('خاصية المشاركة غير مدعومة! جرب الأزرار الأخرى.');
                showGuardianComment('المتصفح ما عاوناش! جرب WhatsApp ولا Facebook 😅');
            }
        }

        function shareToWhatsApp() {
            const text = encodeURIComponent(`عمري حسب حاسبة العمر الجزائرية! 😎 اكتشف عمرك: ${window.location.href}`);
            window.open(`https://api.whatsapp.com/send?text=${text}`, '_blank');
        }

        function shareToFacebook() {
            const url = encodeURIComponent(window.location.href);
            window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}`, '_blank');
        }

        function shareToX() {
            const text = encodeURIComponent('اكتشفت عمري بطريقة جزائرية مضحكة! 😎 جربوها!');
            const url = encodeURIComponent(window.location.href);
            window.open(`https://x.com/intent/tweet?text=${text}&url=${url}`, '_blank');
        }

        function shareToMessenger() {
            const url = encodeURIComponent(window.location.href);
            window.open(`fb-messenger://share/?link=${url}`, '_blank');
        }

        function generateQR() {
            const userName = sessionStorage.getItem('userName');
            const age = sessionStorage.getItem('age');
            const zodiac = sessionStorage.getItem('zodiac');
            const comment = sessionStorage.getItem('comment');
            const qrText = `${window.location.href}?name=${encodeURIComponent(userName)}&age=${age}&zodiac=${zodiac}&comment=${encodeURIComponent(comment)}`;
            const qrCodeDiv = document.getElementById('qrCode');
            qrCodeDiv.innerHTML = '';
            qrCodeDiv.style.display = 'block';
            new QRCode(qrCodeDiv, {
                text: qrText,
                width: 200,
                height: 200
            });
            showGuardianComment('امسح الرمز وشارك عمرك مع الحومة! 😜');
            setTimeout(() => {
                qrCodeDiv.style.display = 'none';
            }, 10000);
        }

        function generateCertificate() {
            const frameStyle = sessionStorage.getItem('frameStyle') || 'default';
            const bgColor = sessionStorage.getItem('bgColor') || 'white';
            const certificateFrame = document.getElementById('certificateFrame');
            certificateFrame.className = `frame ${frameStyle}`;
            certificateFrame.style.background = bgColor;

            const userName = sessionStorage.getItem('userName');
            const customTitle = sessionStorage.getItem('customTitle');
            const age = sessionStorage.getItem('age');
            const zodiac = sessionStorage.getItem('zodiac');
            const comment = sessionStorage.getItem('comment');
            const date = new Date().toLocaleDateString();

            document.getElementById('certificateName').innerText = `الاسم: ${userName} 🇩🇿`;
            document.getElementById('certificateTitle').innerText = `اللقب: ${customTitle}`;
            document.getElementById('certificateAge').innerText = `العمر: ${age} سنة`;
            document.getElementById('certificateZodiac').innerText = `البرج: ${zodiac}`;
            document.getElementById('certificateComment').innerText = `تعليق: ${comment}`;
            document.getElementById('certificateDate').innerText = `تاريخ الإصدار: ${date} ☕`;

            const certificateContainer = document.getElementById('certificateContainer');
            certificateContainer.style.display = 'block';

            html2canvas(certificateContainer, { scale: 2 }).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const link = document.createElement('a');
                link.href = imgData;
                link.download = `شهادة_عمر_${userName}_${date}.png`;
                link.click();
            }).catch(err => console.error('خطأ في إنشاء الشهادة:', err));

            showGuardianComment('شهادة فخمة كيما الكسكس! شاركها مع الصحاب! 🍲');
            setTimeout(() => {
                certificateContainer.style.display = 'none';
            }, 1000);
        }
    </script>
</body>
</html>